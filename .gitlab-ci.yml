image: node:20

# Cache modules in between jobs to speed up builds
cache:
  paths:
    - node_modules/

pages:
  stage: deploy
  script:
    - npm install
    # Build the project with the correct base path for GitLab Pages
    # Assuming the repository name is 'portfolio' (lowercase based on git url)
    - npm run build -- --base=/portfolio/
    # GitLab Pages serves content from a folder named 'public'
    # We need to move our 'dist' (created by Vite) to 'public'
    - rm -rf public
    - mv dist public
  artifacts:
    paths:
      - public
  only:
    - main
